(()=>{"use strict";var e,t={654:()=>{const e=window.wp.blocks,t=window.wp.i18n,o=window.React,a=window.wp.blockEditor,r=window.wp.components,l=window.wp.element;(0,e.registerBlockType)("todoistberg/todo-list",{title:(0,t.__)("Todoist Task List","todoistberg"),description:(0,t.__)("Display tasks from a Todoist project.","todoistberg"),category:"todoist",icon:"list-view",keywords:[(0,t.__)("todoist","todoistberg"),(0,t.__)("tasks","todoistberg"),(0,t.__)("todo","todoistberg"),(0,t.__)("list","todoistberg")],supports:{html:!1,align:["wide","full"]},attributes:{projectId:{type:"string",default:""},maxItems:{type:"number",default:10},showCompleted:{type:"boolean",default:!1},title:{type:"string",default:""},borderWidth:{type:"number",default:0},borderColor:{type:"string",default:"#ddd"},borderRadius:{type:"number",default:0},backgroundColor:{type:"string",default:"#fff"},margin:{type:"number",default:20},padding:{type:"number",default:20},headlineAlignment:{type:"string",default:"left"}},edit:function({attributes:e,setAttributes:s}){const{projectId:n,maxItems:i,showCompleted:d,title:g,borderWidth:c,borderColor:b,borderRadius:m,backgroundColor:p,margin:u,padding:h,headlineAlignment:_}=e,[w,E]=(0,l.useState)([]),[C,f]=(0,l.useState)(!1),[y,k]=(0,l.useState)(""),[x,T]=(0,l.useState)([]),v=(0,a.useBlockProps)({className:"todoistberg-todo-list",style:{border:c?`${c}px solid ${b}`:"none",borderRadius:`${m}px`,backgroundColor:p,marginBottom:`${u}px`,padding:`${h}px`}});(0,l.useEffect)(()=>{window.todoistbergData&&window.todoistbergData.projects&&T(window.todoistbergData.projects)},[]),(0,l.useEffect)(()=>{n?S():E([])},[n,i,d]);const S=async()=>{f(!0),k("");try{const e=await fetch(`/wp-json/todoistberg/v1/tasks?project_id=${n}&max_items=${i}&show_completed=${d}`,{headers:{"X-WP-Nonce":window.todoistbergData?.nonce||""}});if(!e.ok)throw new Error("Failed to fetch tasks");const t=await e.json();E(t)}catch(e){k(e.message),E([])}finally{f(!1)}};return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(a.InspectorControls,null,(0,o.createElement)(r.PanelBody,{title:(0,t.__)("Todoist Settings","todoistberg")},(0,o.createElement)(r.SelectControl,{label:(0,t.__)("Project","todoistberg"),value:n,options:[{label:(0,t.__)("Select a project...","todoistberg"),value:""},{label:(0,t.__)("All Projects","todoistberg"),value:"all"},...x],onChange:e=>s({projectId:e})}),(0,o.createElement)(r.RangeControl,{label:(0,t.__)("Maximum Items","todoistberg"),value:i,onChange:e=>s({maxItems:e}),min:1,max:50}),(0,o.createElement)(r.ToggleControl,{label:(0,t.__)("Show Completed Tasks","todoistberg"),checked:d,onChange:e=>s({showCompleted:e})})),(0,o.createElement)(r.PanelBody,{title:(0,t.__)("Block Styling","todoistberg"),initialOpen:!1},(0,o.createElement)(r.RangeControl,{label:(0,t.__)("Border Width","todoistberg"),value:c,onChange:e=>s({borderWidth:e}),min:0,max:10}),(0,o.createElement)("div",{style:{marginTop:"16px"}},(0,o.createElement)("label",{style:{display:"block",marginBottom:"8px",fontSize:"11px",fontWeight:"500",textTransform:"uppercase"}},(0,t.__)("Border Color","todoistberg")),(0,o.createElement)(r.ColorPicker,{color:b,onChange:e=>s({borderColor:e}),enableAlpha:!0})),(0,o.createElement)(r.RangeControl,{label:(0,t.__)("Corner Radius","todoistberg"),value:m,onChange:e=>s({borderRadius:e}),min:0,max:50}),(0,o.createElement)("div",{style:{marginTop:"16px"}},(0,o.createElement)("label",{style:{display:"block",marginBottom:"8px",fontSize:"11px",fontWeight:"500",textTransform:"uppercase"}},(0,t.__)("Background Color","todoistberg")),(0,o.createElement)(r.ColorPicker,{color:p,onChange:e=>s({backgroundColor:e}),enableAlpha:!0})),(0,o.createElement)(r.RangeControl,{label:(0,t.__)("Margin (px)","todoistberg"),value:u,onChange:e=>s({margin:e}),min:0,max:100}),(0,o.createElement)(r.RangeControl,{label:(0,t.__)("Padding (px)","todoistberg"),value:h,onChange:e=>s({padding:e}),min:0,max:100})),(0,o.createElement)(r.PanelBody,{title:(0,t.__)("Headline Settings","todoistberg"),initialOpen:!1},(0,o.createElement)(r.SelectControl,{label:(0,t.__)("Headline Alignment","todoistberg"),value:_,options:[{label:(0,t.__)("Left","todoistberg"),value:"left"},{label:(0,t.__)("Center","todoistberg"),value:"center"},{label:(0,t.__)("Right","todoistberg"),value:"right"}],onChange:e=>s({headlineAlignment:e})}))),(0,o.createElement)("div",{...v},(0,o.createElement)(a.RichText,{tagName:"h3",className:"todoistberg-title",style:{textAlign:_},value:g,onChange:e=>s({title:e}),placeholder:(0,t.__)("Enter title...","todoistberg")}),window.todoistbergData?.hasToken?n?(0,o.createElement)(r.Card,null,(0,o.createElement)(r.CardHeader,null,(0,o.createElement)("h4",null,(0,t.__)("Preview","todoistberg"))),(0,o.createElement)(r.CardBody,null,C?(0,o.createElement)("div",{style:{textAlign:"center",padding:"20px"}},(0,o.createElement)(r.Spinner,null),(0,o.createElement)("p",null,(0,t.__)("Loading tasks...","todoistberg"))):y?(0,o.createElement)(r.Notice,{status:"error",isDismissible:!1},y):0===w.length?(0,o.createElement)("p",{className:"todoistberg-no-tasks"},(0,t.__)("No tasks found.","todoistberg")):(0,o.createElement)("ul",{className:"todoistberg-tasks"},w.map(e=>(0,o.createElement)("li",{key:e.id,className:"todoistberg-task "+(e.completed?"completed":"")},(0,o.createElement)("span",{className:"todoistberg-task-content"},e.content),e.due&&(0,o.createElement)("span",{className:"todoistberg-task-due"},new Date(e.due.date).toLocaleDateString())))))):(0,o.createElement)(r.Placeholder,{icon:"list-view",label:(0,t.__)("Todoist Task List","todoistberg"),instructions:(0,t.__)("Select a project from the block settings to display tasks.","todoistberg")}):(0,o.createElement)(r.Notice,{status:"warning",isDismissible:!1},(0,t.__)("Please configure your Todoist API token in the plugin settings.","todoistberg"))))},save:()=>null}),(0,e.registerBlockType)("todoistberg/todo-stats",{title:(0,t.__)("Todoist Completion Statistics","todoistberg"),description:(0,t.__)("Display completed Todoist tasks statistics.","todoistberg"),category:"todoist",icon:"chart-bar",keywords:[(0,t.__)("todoist","todoistberg"),(0,t.__)("statistics","todoistberg"),(0,t.__)("stats","todoistberg"),(0,t.__)("progress","todoistberg")],supports:{html:!1,align:["wide","full"]},attributes:{showToday:{type:"boolean",default:!0},showWeek:{type:"boolean",default:!0},showMonth:{type:"boolean",default:!0},showPastDue:{type:"boolean",default:!1},numberColor:{type:"string",default:"#007cba"},title:{type:"string",default:"Todoist Completion Statistics"},borderWidth:{type:"number",default:0},borderColor:{type:"string",default:"#ddd"},borderRadius:{type:"number",default:0},backgroundColor:{type:"string",default:"#fff"},margin:{type:"number",default:20},padding:{type:"number",default:20},headlineAlignment:{type:"string",default:"center"}},edit:function({attributes:e,setAttributes:s}){console.log("ðŸ” TodoStatsBlock attributes:",e);const{showToday:n,showWeek:i,showMonth:d,showPastDue:g,numberColor:c,borderWidth:b,borderColor:m,borderRadius:p,backgroundColor:u,margin:h,padding:_,headlineAlignment:w,title:E}=e,[C,f]=(0,l.useState)({}),[y,k]=(0,l.useState)(!1),[x,T]=(0,l.useState)(""),v=(0,a.useBlockProps)({className:"todoistberg-todo-stats",style:{border:b?`${b}px solid ${m}`:"none",borderRadius:`${p}px`,backgroundColor:u,marginBottom:`${h}px`,padding:`${_}px`}});(0,l.useEffect)(()=>{window.todoistbergData?.hasToken&&S()},[n,i,d,g]);const S=async()=>{console.log("ðŸ”„ Todoistberg: Starting stats fetch..."),console.log("ðŸ“Š Todoistberg: Show settings:",{showToday:n,showWeek:i,showMonth:d,showPastDue:g}),k(!0),T("");try{const e=new FormData;e.append("action","todoistberg_get_stats"),e.append("show_today",n),e.append("show_week",i),e.append("show_month",d),e.append("show_past_due",g),e.append("nonce",window.todoistbergData?.nonce||"");const t=window.todoistbergData?.ajaxUrl||window.todoistbergFrontend?.ajaxUrl||window.ajaxurl||"/wp-admin/admin-ajax.php";console.log("ðŸ“¤ Todoistberg: Sending AJAX request to:",t),console.log("ðŸ”‘ Todoistberg: Has token:",!!window.todoistbergData?.hasToken);const o=await fetch(t,{method:"POST",body:e});if(console.log("ðŸ“¥ Todoistberg: Response status:",o.status),console.log("ðŸ“¥ Todoistberg: Response ok:",o.ok),!o.ok)throw new Error("Failed to fetch statistics");const a=await o.json();if(console.log("ðŸ“Š Todoistberg: Response data:",a),!a.success)throw console.error("âŒ Todoistberg: API error:",a.data),new Error(a.data||"Failed to fetch statistics");console.log("âœ… Todoistberg: Stats received:",a.data),f(a.data)}catch(e){console.error("ðŸ’¥ Todoistberg: Fetch error:",e),T(e.message),f({})}finally{k(!1),console.log("ðŸ Todoistberg: Stats fetch completed")}};return console.log("ðŸ”§ Rendering InspectorControls panel"),console.log("ðŸ”§ showPastDue value:",g),(0,o.createElement)(o.Fragment,null,(0,o.createElement)(a.InspectorControls,null,(0,o.createElement)(r.PanelBody,{title:(0,t.__)("Statistics Settings","todoistberg"),initialOpen:!0},(0,o.createElement)(r.ToggleControl,{label:(0,t.__)("Show Today","todoistberg"),checked:n,onChange:e=>s({showToday:e})}),(0,o.createElement)(r.ToggleControl,{label:(0,t.__)("Show This Week","todoistberg"),checked:i,onChange:e=>s({showWeek:e})}),(0,o.createElement)(r.ToggleControl,{label:(0,t.__)("Show This Month","todoistberg"),checked:d,onChange:e=>s({showMonth:e})}),(0,o.createElement)(r.ToggleControl,{label:(0,t.__)("Show Past Due Tasks","todoistberg"),checked:g,onChange:e=>s({showPastDue:e})}),(0,o.createElement)("div",{style:{marginTop:"16px"}},(0,o.createElement)("label",{style:{display:"block",marginBottom:"8px",fontSize:"11px",fontWeight:"500",textTransform:"uppercase"}},(0,t.__)("Number Color","todoistberg")),(0,o.createElement)(r.ColorPicker,{color:c,onChange:e=>s({numberColor:e}),enableAlpha:!0}))),(0,o.createElement)(r.PanelBody,{title:(0,t.__)("Block Styling","todoistberg"),initialOpen:!1},(0,o.createElement)(r.RangeControl,{label:(0,t.__)("Border Width","todoistberg"),value:b,onChange:e=>s({borderWidth:e}),min:0,max:10}),(0,o.createElement)("div",{style:{marginTop:"16px"}},(0,o.createElement)("label",{style:{display:"block",marginBottom:"8px",fontSize:"11px",fontWeight:"500",textTransform:"uppercase"}},(0,t.__)("Border Color","todoistberg")),(0,o.createElement)(r.ColorPicker,{color:m,onChange:e=>s({borderColor:e}),enableAlpha:!0})),(0,o.createElement)(r.RangeControl,{label:(0,t.__)("Corner Radius","todoistberg"),value:p,onChange:e=>s({borderRadius:e}),min:0,max:50}),(0,o.createElement)("div",{style:{marginTop:"16px"}},(0,o.createElement)("label",{style:{display:"block",marginBottom:"8px",fontSize:"11px",fontWeight:"500",textTransform:"uppercase"}},(0,t.__)("Background Color","todoistberg")),(0,o.createElement)(r.ColorPicker,{color:u,onChange:e=>s({backgroundColor:e}),enableAlpha:!0})),(0,o.createElement)(r.RangeControl,{label:(0,t.__)("Margin (px)","todoistberg"),value:h,onChange:e=>s({margin:e}),min:0,max:100}),(0,o.createElement)(r.RangeControl,{label:(0,t.__)("Padding (px)","todoistberg"),value:_,onChange:e=>s({padding:e}),min:0,max:100})),(0,o.createElement)(r.PanelBody,{title:(0,t.__)("Headline Settings","todoistberg"),initialOpen:!1},(0,o.createElement)(r.SelectControl,{label:(0,t.__)("Headline Alignment","todoistberg"),value:w,options:[{label:(0,t.__)("Left","todoistberg"),value:"left"},{label:(0,t.__)("Center","todoistberg"),value:"center"},{label:(0,t.__)("Right","todoistberg"),value:"right"}],onChange:e=>s({headlineAlignment:e})}))),(0,o.createElement)("div",{...v},(0,o.createElement)(a.RichText,{tagName:"h3",className:"todoistberg-stats-title",style:{textAlign:w},value:E,onChange:e=>s({title:e}),placeholder:(0,t.__)("Enter title...","todoistberg")}),window.todoistbergData?.hasToken?(0,o.createElement)(r.Card,null,(0,o.createElement)(r.CardHeader,null,(0,o.createElement)("h4",null,(0,t.__)("Statistics Preview","todoistberg"))),(0,o.createElement)(r.CardBody,null,y?(0,o.createElement)("div",{style:{textAlign:"center",padding:"20px"}},(0,o.createElement)(r.Spinner,null),(0,o.createElement)("p",null,(0,t.__)("Loading statistics...","todoistberg"))):x?(0,o.createElement)(r.Notice,{status:"error",isDismissible:!1},x):(0,o.createElement)("div",{className:"todoistberg-stats-grid"},n&&(0,o.createElement)("div",{className:"todoistberg-stat-item"},(0,o.createElement)("span",{className:"todoistberg-stat-number",style:{color:c}},C.today||0),(0,o.createElement)("span",{className:"todoistberg-stat-label"},(0,t.__)("Completed Today","todoistberg"))),i&&(0,o.createElement)("div",{className:"todoistberg-stat-item"},(0,o.createElement)("span",{className:"todoistberg-stat-number",style:{color:c}},C.week||0),(0,o.createElement)("span",{className:"todoistberg-stat-label"},(0,t.__)("Completed This Week","todoistberg"))),d&&(0,o.createElement)("div",{className:"todoistberg-stat-item"},(0,o.createElement)("span",{className:"todoistberg-stat-number",style:{color:c}},C.month||0),(0,o.createElement)("span",{className:"todoistberg-stat-label"},(0,t.__)("Completed This Month","todoistberg"))),g&&(0,o.createElement)("div",{className:"todoistberg-stat-item todoistberg-stat-past-due"},(0,o.createElement)("span",{className:"todoistberg-stat-number"},C.pastDue||0),(0,o.createElement)("span",{className:"todoistberg-stat-label"},(0,t.__)("Past Due Tasks","todoistberg")))))):(0,o.createElement)(r.Notice,{status:"warning",isDismissible:!1},(0,t.__)("Please configure your Todoist API token in the plugin settings.","todoistberg"))))},save:()=>null})}},o={};function a(e){var r=o[e];if(void 0!==r)return r.exports;var l=o[e]={exports:{}};return t[e](l,l.exports,a),l.exports}a.m=t,e=[],a.O=(t,o,r,l)=>{if(!o){var s=1/0;for(g=0;g<e.length;g++){for(var[o,r,l]=e[g],n=!0,i=0;i<o.length;i++)(!1&l||s>=l)&&Object.keys(a.O).every(e=>a.O[e](o[i]))?o.splice(i--,1):(n=!1,l<s&&(s=l));if(n){e.splice(g--,1);var d=r();void 0!==d&&(t=d)}}return t}l=l||0;for(var g=e.length;g>0&&e[g-1][2]>l;g--)e[g]=e[g-1];e[g]=[o,r,l]},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};a.O.j=t=>0===e[t];var t=(t,o)=>{var r,l,[s,n,i]=o,d=0;if(s.some(t=>0!==e[t])){for(r in n)a.o(n,r)&&(a.m[r]=n[r]);if(i)var g=i(a)}for(t&&t(o);d<s.length;d++)l=s[d],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(g)},o=globalThis.webpackChunktodoistberg=globalThis.webpackChunktodoistberg||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var r=a.O(void 0,[350],()=>a(654));r=a.O(r)})();